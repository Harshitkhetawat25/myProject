<style>
  .btn-search {
    background-color: #fe424d;
    color: #fff;
    border-radius: 25px;
    padding: 8px 16px;
  }
  .navbar .btn-search:hover {
    background-color: #e63946;
    color: #fff;
  }
  .navbar .btn-search i {
    display: inline;
    margin-right: 0.5rem;
  }
  .navbar .search-input {
    border-radius: 25px;
    padding: 0.5rem 3rem 0.5rem 3rem;
  }
  
  /* Logo styling */
  .navbar-brand {
    font-size: 1.5rem;
    font-weight: bold;
    color: #fe424d !important;
    text-decoration: none;
  }
  .navbar-brand:hover {
    color: #e63946 !important;
  }
  
  /* Create listing button styling */
  .btn-create-listing {
    background-color: #28a745;
    color: white;
    border-radius: 20px;
    padding: 6px 12px;
    text-decoration: none;
    border: none;
    font-weight: 500;
    transition: background-color 0.3s ease;
  }
  .btn-create-listing:hover {
    background-color: #218838;
    color: white;
    text-decoration: none;
  }
  
  /* User menu styling */
  .user-menu {
    display: flex;
    align-items: center;
    gap: 1rem;
  }
  
  .nav-link {
    transition: color 0.3s ease;
  }
  
  .nav-link:hover {
    color: #fe424d !important;
  }
  
  /* Welcome user text */
  .welcome-user {
    color: #6c757d;
    font-size: 0.9rem;
    margin-right: 0.5rem;
  }
  
  /* Mobile dropdown styles */
  @media (max-width: 767.98px) {
    .navbar-collapse {
      background-color: rgba(255, 255, 255, 0.95);
      padding: 0.5rem;
      border-radius: 8px;
      margin-top: 0.5rem;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      position: relative;
      z-index: 1000;
    }
    .navbar-collapse.show {
      display: block;
      height: auto;
    }
    .navbar-nav {
      flex-direction: column;
      align-items: flex-start;
    }
    .navbar-nav .nav-link {
      padding: 0.3rem 0;
      font-size: 0.9rem;
    }
    .navbar-nav.ms-auto {
      margin-top: 0.5rem;
    }
    .navbar form.d-flex {
      width: 100%;
      margin: 0.5rem 0;
    }
    .navbar .search-input {
      width: 100%;
      font-size: 0.9rem;
      padding: 0.5rem 2rem;
    }
    .user-menu {
      flex-direction: column;
      align-items: flex-start;
      gap: 0.5rem;
      width: 100%;
    }
    .btn-create-listing {
      width: 100%;
      text-align: center;
      margin: 0.5rem 0;
    }
    /* Adjusted margin to avoid overlap with filters */
    .navbar-expanded + .container,
    .navbar-expanded + main,
    .navbar-expanded + div {
      margin-top: 6rem;
      transition: margin-top 0.3s ease;
    }
  }
</style>

<nav class="navbar navbar-expand-md bg-body-tertiary border-bottom sticky-top">
  <div class="container-fluid">
    <!-- Logo/Brand -->
    <a class="navbar-brand" href="/listings">
      <i class="fa-solid fa-home"></i> WanderWhirl
    </a>
    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    
    <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
      <!-- Left side navigation -->
   
      
      <!-- Center - Search bar -->
      <div class="navbar-nav ms-auto">
        <form class="d-flex" role="search" action="/listings/search" method="GET">
          <input class="form-control me-2 search-input" type="search" name="query" placeholder="Search destinations..." aria-label="Search" value="<%= typeof query !== 'undefined' ? query : '' %>"/>
          <button class="btn btn-search" type="submit">
            <i class="fa-solid fa-magnifying-glass"></i>Search
          </button>
        </form>
      </div>
      
      <!-- Right side - User menu -->
      <div class="navbar-nav ms-auto">
        <div class="user-menu">
          <!-- Create New Listing Button -->
          <a class="btn btn-create-listing" href="/listings/new">
            <i class="fa-solid fa-plus"></i> Add your Home
          </a>
          
          <% if(currUser) { %>
            <!-- Welcome message -->
            <span class="welcome-user">Hi, <%= currUser.username || 'User' %>!</span>
            
            <!-- My Bookings -->
            <a class="nav-link" href="/bookings/my-bookings">
              <i class="fa-solid fa-calendar-check"></i> My Bookings
            </a>
            
            <!-- Logout -->
            <a class="nav-link" href="/logout">
              <i class="fa-solid fa-sign-out-alt"></i> Logout
            </a>
          <% } else { %>
            <!-- Sign Up -->
            <a class="nav-link" href="/signup">
              <i class="fa-solid fa-user-plus"></i> <b>Sign Up</b>
            </a>
            
            <!-- Login -->
            <a class="nav-link" href="/login">
              <i class="fa-solid fa-sign-in-alt"></i> <b>Login</b>
            </a>
          <% } %>
        </div>
      </div>
    </div>
  </div>
</nav>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const toggler = document.querySelector('.navbar-toggler');
    const collapse = document.querySelector('.navbar-collapse');
    
    toggler.addEventListener('click', () => {
      if (collapse.classList.contains('show')) {
        document.body.classList.remove('navbar-expanded');
      } else {
        document.body.classList.add('navbar-expanded');
      }
    });
    
    collapse.addEventListener('hidden.bs.collapse', () => {
      document.body.classList.remove('navbar-expanded');
    });
  });
</script>