<% layout("layouts/boilerplate") %>
<style>
    .password-feedback {
        font-size: 0.8rem;
        color: #dc3545;
        margin-top: 0.25rem;
    }
    .password-feedback.valid {
        color: #28a745;
    }
    @media (max-width: 767.98px) {
        .password-feedback {
            font-size: 0.7rem;
        }
        .form-control {
            font-size: 0.9rem;
            padding: 0.5rem;
        }
        .form-label {
            font-size: 0.9rem;
        }
        .col-6.offset-3 {
            padding: 0 0.5rem;
        }
        .btn-dark {
            padding: 0.5rem;
            font-size: 0.9rem;
        }
    }
</style>
<div class="row mt-3">
    <div class="col-6 offset-3">
        <h1 class="col-6 offset-3">Login on WanderWhirl</h1>
        <form action="/login" method="POST" class="needs-validation" novalidate>
            <div class="mb-3">
                <label for="username" class="form-label">Username</label>
                <input type="text" name="username" id="username" class="form-control" required>
                <div class="invalid-feedback">Please enter a username</div>
            </div>
            <div class="mb-3">
                <label for="password" class="form-label">Password</label>
                <input type="password" name="password" id="password" class="form-control" required>
                <div class="invalid-feedback">Please enter a password</div>
                <div id="passwordFeedback">
                    <div class="password-feedback" id="length">At least 8 characters</div>
                    <div class="password-feedback" id="uppercase">One uppercase letter</div>
                    <div class="password-feedback" id="lowercase">One lowercase letter</div>
                    <div class="password-feedback" id="number">One number</div>
                </div>
            </div>
            <button class="btn btn-dark">Login</button>
        </form>
    </div>
</div>

<script>
    const passwordInput = document.getElementById('password');
    const lengthFeedback = document.getElementById('length');
    const uppercaseFeedback = document.getElementById('uppercase');
    const lowercaseFeedback = document.getElementById('lowercase');
    const numberFeedback = document.getElementById('number');
    const form = document.querySelector('.needs-validation');
    const submitButton = form.querySelector('button');

    function validatePassword() {
        const password = passwordInput.value;

        // Check length
        if (password.length >= 8) {
            lengthFeedback.classList.add('valid');
            lengthFeedback.textContent = '✓ At least 8 characters';
        } else {
            lengthFeedback.classList.remove('valid');
            lengthFeedback.textContent = 'At least 8 characters';
        }

        // Check uppercase
        if (/[A-Z]/.test(password)) {
            uppercaseFeedback.classList.add('valid');
            uppercaseFeedback.textContent = '✓ One uppercase letter';
        } else {
            uppercaseFeedback.classList.remove('valid');
            uppercaseFeedback.textContent = 'One uppercase letter';
        }

        // Check lowercase
        if (/[a-z]/.test(password)) {
            lowercaseFeedback.classList.add('valid');
            lowercaseFeedback.textContent = '✓ One lowercase letter';
        } else {
            lowercaseFeedback.classList.remove('valid');
            lowercaseFeedback.textContent = 'One lowercase letter';
        }

        // Check number
        if (/\d/.test(password)) {
            numberFeedback.classList.add('valid');
            numberFeedback.textContent = '✓ One number';
        } else {
            numberFeedback.classList.remove('valid');
            numberFeedback.textContent = 'One number';
        }
    }

    passwordInput.addEventListener('input', validatePassword);

    // Bootstrap validation
    form.addEventListener('submit', (event) => {
        if (!form.checkValidity()) {
            event.preventDefault();
            event.stopPropagation();
        }
        form.classList.add('was-validated');
    });
</script>